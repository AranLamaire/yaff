
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>1. Yaff experiments on alpha quartz with the BKS potential &#8212; Yaff 1.4.2 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.4.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="1. yaff – YAFF - Yet another force field" href="rg_yaff.html" />
    <link rel="prev" title="11. Tuning force field parameters" href="ug_tune.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rg_yaff.html" title="1. yaff – YAFF - Yet another force field"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ug_tune.html" title="11. Tuning force field parameters"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Yaff 1.4.2 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="yaff-experiments-on-alpha-quartz-with-the-bks-potential">
<span id="tu-sec-silica"></span><h1>1. Yaff experiments on alpha quartz with the BKS potential<a class="headerlink" href="#yaff-experiments-on-alpha-quartz-with-the-bks-potential" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>1.1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces some basic features of Yaff with the aid of relatively
simple simulations using the BKS force field <a class="reference internal" href="#bks1990" id="id1">[BKS1990]</a>. The files needed for
this tutorial are distributed with the source code of Yaff in the directory
<code class="docutils literal"><span class="pre">data/examples/001_toturial_bks</span></code>. This tutorial assumes that you have
successfuly installed Yaff. (See <a class="reference internal" href="ug_install.html#ug-sec-install"><span class="std std-ref">Installation</span></a> for more details.)</p>
<p>A copy of the latest source code with the examples can be obtained with the
following commands:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">git</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">molmod</span><span class="o">/</span><span class="n">yaff</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">yaff</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="mi">001</span><span class="n">_tutorial_bks</span>
</pre></div>
</div>
<p>The directory <code class="docutils literal"><span class="pre">data/examples/001_toturial_bks</span></code> contains three directories
(<code class="docutils literal"><span class="pre">init</span></code>, <code class="docutils literal"><span class="pre">opt</span></code> and <code class="docutils literal"><span class="pre">nvt</span></code>) and a file <code class="docutils literal"><span class="pre">bks.pot</span></code>. The latter contains the
parameters of the BKS force field. The <code class="docutils literal"><span class="pre">init</span></code> directory just contains a script
and some input data to set up the initial structure of alpha quartz. The
directories <code class="docutils literal"><span class="pre">opt</span></code> and <code class="docutils literal"><span class="pre">nvt</span></code> each contain a simulation script
(<code class="docutils literal"><span class="pre">simulation.py</span></code>) and an analysis script (<code class="docutils literal"><span class="pre">analysis.py</span></code>). All scripts
contain an abundant amount of comments to explain each step and the parameters
that are used. The simulation script in the <code class="docutils literal"><span class="pre">opt</span></code> directory can be used to
optimize the positions of the nuclei and/or the cell geometry. The corresponding
analysis script can be used to fit the bulk modulus to a series of
<span class="math">\((p,V,E)\)</span> data points. The directory <code class="docutils literal"><span class="pre">nvt</span></code> contains a simulation script
to run an NVT simulation on the quartz system. The analysis script computes the
average pressure and the error on that average.</p>
</div>
<div class="section" id="preparation">
<h2>1.2. Preparation<a class="headerlink" href="#preparation" title="Permalink to this headline">¶</a></h2>
<p>In order to prepare an initial structure, run the script <code class="docutils literal"><span class="pre">mksystem.py</span></code> in the
directory <code class="docutils literal"><span class="pre">init</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">init</span>
<span class="n">python</span> <span class="n">mksystem</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>This script uses data from the files <code class="docutils literal"><span class="pre">rvecs.txt</span></code> and <code class="docutils literal"><span class="pre">struct.xyz</span></code> to
construct an initial state for the simulations in the following section. One may
modify the scripts to construct alternative initial states.</p>
</div>
<div class="section" id="bulk-modulus">
<h2>1.3. Bulk modulus<a class="headerlink" href="#bulk-modulus" title="Permalink to this headline">¶</a></h2>
<p>The goal of the first assignment is to estimate the bulk modulus of quartz at
<span class="math">\(T=0K\)</span> and an external pressure of <span class="math">\(p_\text{ext}=0\;\text{bar}\)</span>.
This result can be obtained in (at least) two ways, either by fitting a linear
model to the <span class="math">\(p(V)\)</span> relation, or by fitting a quadratic model to the
<span class="math">\(E(V)\)</span> relation. More advanced approaches such as a fit to the
<a class="reference external" href="http://en.wikipedia.org/wiki/Birch%E2%80%93Murnaghan_equation_of_state">Birch–Murnaghan equation of state</a> or a
direct computation of <span class="math">\(\frac{d^2 E}{d V^2}\)</span> are also possible but are not
discussed here for the sake of simplicity.</p>
<p>The script <code class="docutils literal"><span class="pre">simulation.py</span></code> in the directory <code class="docutils literal"><span class="pre">opt</span></code> can be used to optimize
the structure of a quartz with a given external pressure. It uses the file
<code class="docutils literal"><span class="pre">init.chk</span></code> from the directory <code class="docutils literal"><span class="pre">init</span></code> as the initial structure for the
optimization. The script can be executed as follows: <code class="docutils literal"><span class="pre">python</span> <span class="pre">simulation.py</span></code>.</p>
<p>As a final result, the individual contributions to the total force field energy
of the optimized system and the optimal cell volume are printed on screen. Run
several tests to see which values for the parameters in the script
<code class="docutils literal"><span class="pre">simulation.py</span></code> are suitable. The script creates several additional output
files that can be used to analyze the optimization:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">traj.xyz</span></code>: a trajectory file with the nuclear coordinates at each time step
that can be visualized with Molden, VMD and many other programs, e.g. <code class="docutils literal"><span class="pre">molden</span>
<span class="pre">traj.xyz</span></code></li>
<li><code class="docutils literal"><span class="pre">opt_energy.png</span></code>: a figure with the energy contributions as function of the
optimization step. This file can be viewed with the command <code class="docutils literal"><span class="pre">display</span>
<span class="pre">opt_energy.png</span></code>.</li>
<li><code class="docutils literal"><span class="pre">opt_cell.png</span></code>: a figure with the cell parameters as function of the
optimization step. This file can be viewed with the command <code class="docutils literal"><span class="pre">display</span>
<span class="pre">opt_cell.png</span></code>.</li>
<li><code class="docutils literal"><span class="pre">opt.chk</span></code>: a file with the optimized structure.</li>
</ul>
<p>Once an acceptable set of <span class="math">\((p,V,E)\)</span> datapoints are obtained, these values
can be added to the beginning of the script <code class="docutils literal"><span class="pre">analysis.py</span></code>. Run this script
(python <code class="docutils literal"><span class="pre">analysis.py</span></code>) to perform the fitting procedure. Besides the screen
output, two figures are generated: <code class="docutils literal"><span class="pre">pv.png</span></code> and <code class="docutils literal"><span class="pre">ev.png</span></code>, which contain your
data and the fitted models. The data point with the smallest pressure (in
absolute value) is used as the reference point for the fit.</p>
<p>If you are familiar with the Python language, it is worthwhile to add a loop
over different external pressures in the script <code class="docutils literal"><span class="pre">simulation.py</span></code>. This makes it
far easier to solve the problem. Furthermore, one further speed up one’s work
flow by writing the essential output of <code class="docutils literal"><span class="pre">simulation.py</span></code> to a data file that
can be read in the <code class="docutils literal"><span class="pre">analysis.py</span></code> script,</p>
</div>
<div class="section" id="thermal-expansion">
<h2>1.4. Thermal expansion<a class="headerlink" href="#thermal-expansion" title="Permalink to this headline">¶</a></h2>
<p>The volumetric thermal expansion in the limit of <span class="math">\(T=0K\)</span> can be estimated with the following relation:</p>
<div class="math">
\[p = 3 B \alpha_V T\]</div>
<p>where <span class="math">\(p\)</span> is the pressure, <span class="math">\(B\)</span> is the bulk modulus at <span class="math">\(T=0K\)</span>,
<span class="math">\(\alpha_V\)</span> is the thermal expansion coefficient at <span class="math">\(T=0K\)</span> and
<span class="math">\(T\)</span> is the temperature. The bulk modulus from the previous section can be
used. The goal of this section is to estimate <span class="math">\(\alpha_V\)</span> for quartz from
several <span class="math">\((p,T)\)</span> data points obtained with NVT molecular dynamics
simulations. The NVT simulations use the fixed optimized cell parameters from
the structure optimization at <span class="math">\(T=0K\)</span>. (See previous section.)</p>
<p>The script <code class="docutils literal"><span class="pre">simulation.py</span></code> in the directory <code class="docutils literal"><span class="pre">nvt</span></code> performs an NVT
simulation, using the optimized cell from the previous section as initial
structure. (Both the nuclear coordinates and the cell parameters from the
optimization are used. The cell parameters do not change during an NVT
simulation.) The script is executed as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">simulations</span><span class="o">.</span><span class="n">py</span> <span class="mi">300</span> <span class="mi">500</span>
</pre></div>
</div>
<p>The two parameters are the temperature of the thermostat and the number of
simulation steps, respectively. The script contains several parameters that one
may tune to obtain decent results. Especially the choice of the thermostat is
important for the statistical efficiency of the ensemble average of the
pressure. By commenting/uncommenting the appropriate lines in the script, one
may select one of the following thermostats:</p>
<ol class="arabic simple">
<li>The Andersen thermostat. In this algorithm, the nuclear velocities are
regularly reseted at random values from the Maxwell-Boltzmann distribution.</li>
<li>The Langevin thermostat. In this algorithm, the nuclei are slowed down by a
uniform friction coefficient and accelerated by additional random nuclear
forces (collisions with an external bath). Both effects are in equilibrium at
the requested temperature. The two main parameters are the temperature
(obviously) and a time constant that determines the time horizon of the
nuclear motion.</li>
<li>The Nosé-Hoover chains (NHC) thermostat. This method couples the nuclear
motion to a fictitious degree of freedom that represents the heat bath. The
equations of motion only deviate very mildly from the regular Newton
equations of motion. Just like the Langevin thermostat, this thermostat is
controlled mainly by two parameters: the temperature and a time constant.</li>
</ol>
<p>The script <code class="docutils literal"><span class="pre">simulation.py</span></code> generates the following output files, where
<code class="docutils literal"><span class="pre">NNNN</span></code> is the temperature and <code class="docutils literal"><span class="pre">MMMMMM</span></code> is the number of iterations in the
Verlet algorithm:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">traj_NNNN_MMMMMM.xyz</span></code>. This can be used to visualize the time-dependent
nuclear positions, e.g. with VMD.</li>
<li><code class="docutils literal"><span class="pre">traj_NNNN_MMMMMM.h5</span></code>. This a binary trajectory file (similar to
<code class="docutils literal"><span class="pre">traj_NNNN_MMMMMM.xyz</span></code>) that contains all time-dependent information from
the NVT simulation. It is used for the post processing of the simulation. One
may request the contents of such file with <code class="docutils literal"><span class="pre">h5dump</span> <span class="pre">-n</span> <span class="pre">traj_NNNN_MMMMMM.h5</span></code>.</li>
<li><code class="docutils literal"><span class="pre">ener_NNNN_MMMMMM.png</span></code>. This is a plot with the time dependent energies.</li>
<li><code class="docutils literal"><span class="pre">temp_NNNN_MMMMMM.png</span></code>. This is a plot with the time temperature.</li>
<li><code class="docutils literal"><span class="pre">press_NNNN_MMMMMM.png</span></code>. This is a plot with the time pressure.</li>
</ul>
<p>The script <code class="docutils literal"><span class="pre">analysis.py</span></code> computes the average pressure and the error on the
average using the block-average method. The script is executed as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">analysis</span><span class="o">.</span><span class="n">py</span> <span class="mi">300</span> <span class="mi">500</span> <span class="mi">20</span>
</pre></div>
</div>
<p>where the three parameters are the temperature, the length of the simulation and
the number of initial steps to be omitted from the analysis. (Some initial data
points should be omitted because the first part of the simulation consists of an
equilibration period that is not suitable for the computation of ensemble
averages.) This script also generates a plot with the normalized time
correlation function of the pressure and the fitting results of the block
average method. (See <code class="docutils literal"><span class="pre">ac_NNNN_MMMMMM.png</span></code> and <code class="docutils literal"><span class="pre">blav_NNNN_MMMMMM.png</span></code>.)</p>
<p>Feel free to modify both scripts in order to obtain the results as efficiently
as possible. The NVT simulations may take a few minutes, especially when longer
runs are requested. In those cases it is recommended to submit the simulations
on a queuing system.</p>
</div>
<div class="section" id="references">
<h2>1.5. References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils citation" frame="void" id="bks1990" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[BKS1990]</a></td><td>van Beest, B. W. H., Kramer, G. J. &amp; van Santen, R. A. ‘Force
fields for silicas and aluminophosphates based on ab initio calculations’.
<em>Phys. Rev. Lett.</em> <strong>64</strong>, 1955-1958 (1990). URL
<a class="reference external" href="http://dx.doi.org/10.1103/PhysRevLett.64.1955">http://dx.doi.org/10.1103/PhysRevLett.64.1955</a>.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1. Yaff experiments on alpha quartz with the BKS potential</a><ul>
<li><a class="reference internal" href="#introduction">1.1. Introduction</a></li>
<li><a class="reference internal" href="#preparation">1.2. Preparation</a></li>
<li><a class="reference internal" href="#bulk-modulus">1.3. Bulk modulus</a></li>
<li><a class="reference internal" href="#thermal-expansion">1.4. Thermal expansion</a></li>
<li><a class="reference internal" href="#references">1.5. References</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ug_tune.html"
                        title="previous chapter">11. Tuning force field parameters</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="rg_yaff.html"
                        title="next chapter">1. <code class="docutils literal"><span class="pre">yaff</span></code> – YAFF - Yet another force field</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tu_silica.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rg_yaff.html" title="1. yaff – YAFF - Yet another force field"
             >next</a> |</li>
        <li class="right" >
          <a href="ug_tune.html" title="11. Tuning force field parameters"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Yaff 1.4.2 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2011, Toon Verstraelen, Louis Vanduyfhuys.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>